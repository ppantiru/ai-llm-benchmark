{
  "id": "qa_026",
  "prompt": "Puis-je personnaliser les champs de profil utilisateur qui sont remplis \u00e0 partir du fournisseur OpenID Connect dans XWiki?\nJe souhaite mapper des champs de profil utilisateur suppl\u00e9mentaires de mon fournisseur OpenID Connect aux propri\u00e9t\u00e9s de l'utilisateur XWiki. Comment puis-je y parvenir?",
  "expected_answer": "Oui, vous pouvez personnaliser les champs de profil utilisateur qui sont remplis \u00e0 partir du fournisseur OpenID Connect en les mappant dans le fichier `xwiki.properties`.\n\nPour mapper des champs de profil utilisateur suppl\u00e9mentaires, utilisez la propri\u00e9t\u00e9 `oidc.user.mapping`. Voici un exemple de la fa\u00e7on de mapper des propri\u00e9t\u00e9s personnalis\u00e9es:\n\n```\n# oidc.user.mapping=myxproperty1=${oidc.user.subject}\n# oidc.user.mapping=myxproperty2=myprefix-${oidc.user.subject}\n```\n\nRemplacez `myxproperty1` et `myxproperty2` par les noms de propri\u00e9t\u00e9 d'utilisateur XWiki r\u00e9els, et `${oidc.user.subject}` par la variable appropri\u00e9e en fonction des donn\u00e9es fournies par votre fournisseur OpenID Connect.\n\nApr\u00e8s avoir configur\u00e9 les mappages, enregistrez le fichier `xwiki.properties` et red\u00e9marrez XWiki pour appliquer les modifications.",
  "ai_answer": "https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/ \n\n\n Yes, you can customize the user profile fields that are filled from the OpenID Connect provider in XWiki. To map additional user profile fields from your OpenID Connect provider to XWiki user properties, follow these steps:\n\n1. Create a new file named `UserProfile.groovy` (if it doesn't exist) in the `SKINS/[your skin]/templates/user` directory of your XWiki instance.\n2. Open the `UserProfile.groovy` file and add the following lines to map the desired OpenID Connect claims to XWiki user properties:\n\n```groovy\nimport org.xwiki.security.authorization.RightService\nimport org.xwiki.user.UserManager\nimport org.xwiki.users.UserProfile\nimport org.xwiki.users.UserPropertyException\nimport com.nimbusds.oauth2.sdk.id.StateToken\nimport com.nimbusds.openid.connect.sdk.validators.UserInfoValidator\nimport java.util.Map\n\n...\n\nvoid populateUserProfile(UserProfile userProfile, Map<String, Object> claims, RightService rightService, UserManager userManager) throws Exception {\n    // Your custom mappings go here\n    if (claims.containsKey(\"given_name\")) {\n        userProfile.setProperty(\"firstName\", claims.get(\"given_name\"));\n    }\n    if (claims.containsKey(\"family_name\")) {\n        userProfile.setProperty(\"lastName\", claims.get(\"family_name\"));\n    }\n    if (claims.containsKey(\"email\")) {\n        userProfile.setProperty(\"email\", claims.get(\"email\"));\n    }\n    \n    // Other default mappings\n    ...\n}\n\n...\n```\nReplace `[your skin]` with the name of your XWiki skin, and add the desired mappings to the `populateUserProfile` method. Make sure to replace `given_name`, `family_name`, and `email` with the actual OpenID Connect claim names you want to map.\n\n3. Save and close the `UserProfile.groovy` file.\n\nAfter following these steps, XWiki will use your custom mappings when filling user profile fields from the OpenID Connect provider. Keep in mind that this solution might be overwritten during an upgrade, so it's essential to keep track of your changes and apply them again after upgrading XWiki.",
  "sources": [
    {
      "collection_id": "Eval",
      "document_id": "extensions:Extension.OpenID Connect.OpenID Connect Authenticator.WebHome",
      "url": "https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/",
      "content": "\"\\n\\n\\n| openid_connect_16x16.png | **Allow an XWiki instance to authenticate on an OpenID Connect provider** |\\n| --- | --- |\\n\\n**Recommended**\\n\\n| Type | JAR |\\n| --- | --- |\\n| Category | Authenticator |\\n| Developed by | [Thomas Mortagne](https://xwiki.org/xwiki/bin/view/XWiki/ThomasMortagne) |\\n| Active Installs | 146 |\\n| Rating | *  * [1](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/ &quot;Poor&quot;) * [2](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/ &quot;Satisfactory&quot;) * [3](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/ &quot;Good&quot;) * [4](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/ &quot;Very good&quot;) * [5](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/ &quot;Excellent&quot;)    1\u00a0Vo\"",
      "similarity_score": 0.7398893237113953,
      "vector": null
    },
    {
      "collection_id": "Eval",
      "document_id": "extensions:Extension.OpenID Connect.OpenID Connect Authenticator.WebHome",
      "url": "https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/",
      "content": "\"rver\\n\\nA [configuration example for Univention Corporate Server (UCS)](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/OpenID%20Authentication%20with%20UCS/) is available.\\n\\n## Configuration files\\n\\n### xwiki.cfg\\n\\n#-# The authentication management class.  \\nxwiki.authentication.authclass=org.xwiki.contrib.oidc.auth.OIDCAuthServiceImpl### xwiki.properties\\n\\n#-# The base URL of the OpenId Connect Provider to use as starting point to discover the provider configuration.  \\n#-# See following endpoints properties if the provider is does not support OpenID Connect discovery.  \\n#-# If not indicated and not custom endpoint is provided, it will be asked to the user.  \\n# oidc.provider=https://xwikiorg-node1.xwikisas.com/xwiki/oidc  \\n  \\n#-# The generic OpenId Connect endpoints to use to communicate with the provider.  \\n#-# It&#x27;s generally not needed when providing the provider discovery endpoint (which is supposed to provide those enpoints).  \"",
      "similarity_score": 0.7343143820762634,
      "vector": null
    },
    {
      "collection_id": "Eval",
      "document_id": "extensions:Extension.OpenID Connect.OpenID Connect Authenticator.WebHome",
      "url": "https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/",
      "content": "\"point even when the user is not present (not logged in).  \\n#-#\u00a0  \\n#-# But depending on the provider more can be listed.  \\n#-#\u00a0  \\n#-# The default is:  \\n# oidc.scope=openid,profile,email,address,phone  \\n  \\n#-# The response type to control the flow used by the OpenId Connect protocol.  \\n#-# This is often used to control if the information about the user should  \\n#-# be gathered from the userinfo endpoint with a request from XWiki to the provider (&quot;code&quot;, the default)  \\n#-# or the id token directly provided when the provider redirects to XWiki (&quot;id\\\\_token&quot;)  \\n#-# but it&#x27;s also possible to combine.  \\n#-# See https://openid.net/specs/openid-connect-core-1\\\\_0.html#rfc.section.3 for mode details.  \\n#-# For an hybrid flow, use list syntax (so comma or several set) instead of the white space  \\n#-# documented in the specification to separate words.  \\n#-#  \\n#-# The default is:  \\n# oidc.responseType=code  \\n  \\n#-# The method used to access the userinfo endpoint.  \\n#-#\u00a0  \\n#-#\"",
      "similarity_score": 0.7315800189971924,
      "vector": null
    },
    {
      "collection_id": "Eval",
      "document_id": "extensions:Extension.OpenID Connect.OpenID Connect Authenticator.WebHome",
      "url": "https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/",
      "content": "\"Connect/OpenID%20Connect%20Authenticator/#Hxwiki.properties)\\n\\t+ [In-wiki configuration](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/#HIn-wikiconfiguration)\\n\\t+ [Authentication with a domain-based instance](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/#HAuthenticationwithadomain-basedinstance)\\n* [Endpoints](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/#HEndpoints)\\n\\t+ [Callback](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/#HCallback)\\n\\t+ [Back-Channel Logout](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/#HBack-ChannelLogout)\\n* [Bypass OpenID Connect](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/#HBypassOpenIDConnect)\\n* [Group synchronizatio\"",
      "similarity_score": 0.7283691167831421,
      "vector": null
    },
    {
      "collection_id": "Eval",
      "document_id": "extensions:Extension.OpenID Connect.OpenID Connect Authenticator.WebHome",
      "url": "https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/",
      "content": "\"Wiki.\\n\\n  \\nOnce you installed the extension you will need to indicate you want to use it as authenticator with the property xwiki.authentication.authclass in xwiki.cfg file. See [Configuration section](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Authenticator/#HConfiguration) for more details.\\n\\n# Dependencies\\n\\nDependencies for this extension (org.xwiki.contrib.oidc:oidc-authenticator 2.8.6):\\n\\n* org.xwiki.platform:xwiki-platform-oldcore 14.10\\n* com.nimbusds:oauth2-oidc-sdk 11.10.1\\n* [org.xwiki.contrib.oidc:oidc-provider](https://extensions.xwiki.org/xwiki/bin/view/Extension/OpenID%20Connect/OpenID%20Connect%20Provider/) 2.8.6\\n* org.xwiki.contrib.oidc:oidc-authenticator-configuration 2.8.6\\n* org.xwiki.contrib.oidc:oidc-authenticator-user 2.8.6\\n\\n\\n\"",
      "similarity_score": 0.7266250848770142,
      "vector": null
    }
  ]
}